#!/bin/bash

# –ü—É—Ç–∏
TMUX_DIR="$HOME/.tmux"
TMUX_CONF="$TMUX_DIR/tmux.conf"
TMUX_CONF_LINK="$HOME/.tmux.conf"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ ~/.tmux
if [ ! -d "$TMUX_DIR" ]; then
    echo "‚ùå –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è $TMUX_DIR –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ $TMUX_DIR."
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
if [ ! -f "$TMUX_CONF" ]; then
    echo "‚ùå –§–∞–π–ª $TMUX_CONF –Ω–µ –Ω–∞–π–¥–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª tmux.conf —Å—É—â–µ—Å—Ç–≤—É–µ—Ç."
    exit 1
fi

# –°–æ–∑–¥–∞–µ–º —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫—É—é —Å—Å—ã–ª–∫—É
if [ -L "$TMUX_CONF_LINK" ]; then
    echo "üîÑ –°—Å—ã–ª–∫–∞ $TMUX_CONF_LINK —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º..."
    rm "$TMUX_CONF_LINK"
elif [ -f "$TMUX_CONF_LINK" ]; then
    echo "‚ùå –§–∞–π–ª $TMUX_CONF_LINK —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ —ç—Ç–æ –Ω–µ —Å—Å—ã–ª–∫–∞. –£–¥–∞–ª—è–µ–º..."
    rm "$TMUX_CONF_LINK"
fi

ln -s "$TMUX_CONF" "$TMUX_CONF_LINK"
echo "‚úÖ –°–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∞—è —Å—Å—ã–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∞: $TMUX_CONF_LINK -> $TMUX_CONF"

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é tmux (–µ—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω)
if tmux info &>/dev/null; then
    echo "‚ôªÔ∏è  –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é tmux..."
    tmux source-file "$TMUX_CONF"
    echo "‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è tmux —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞!"
else
    echo "‚ÑπÔ∏è  tmux –Ω–µ –∑–∞–ø—É—â–µ–Ω. –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å tmux –∫–æ–º–∞–Ω–¥–æ–π: tmux"
fi
