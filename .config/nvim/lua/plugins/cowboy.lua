-- ~/.config/nvim/lua/plugins/cowboy.lua
local M = {}

function M.cowboy()
	---@type table?
	local id
	local ok = true
	for _, key in ipairs({ "h", "j", "k", "l", "+", "-" }) do
		local count = 0
		local timer = assert(vim.loop.new_timer())
		local map = key
		vim.keymap.set("n", key, function()
			if vim.v.count > 0 then
				count = 0  -- —Å–±—Ä–æ—Å —Å—á—ë—Ç—á–∏–∫–∞, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–µ—Ñ–∏–∫—Å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3h)
			end
			if count >= 10 then
				-- –ö–æ–≥–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–∂–∞—Ç–∏–π –ø—Ä–µ–≤—ã—à–∞–µ—Ç 10, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
				ok, id = pcall(vim.notify, "       Hold it Cowboy!       ", vim.log.levels.WARN, {
					icon = "       ü§†",  -- –ò–∫–æ–Ω–∫–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
					replace = id,  -- –ó–∞–º–µ–Ω—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –µ—â—ë –∞–∫—Ç–∏–≤–Ω–æ
					keep = function()
						return count >= 10  -- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è, –ø–æ–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–∂–∞—Ç–∏–π >= 10
					end,
				})
				if not ok then
					id = nil  -- –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º id
					return map  -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª–∞–≤–∏—à–∏
				end
			else
				count = count + 1  -- –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫
				-- –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ –ø–æ—Å–ª–µ 2 —Å–µ–∫—É–Ω–¥ –±–µ–∑ –Ω–∞–∂–∞—Ç–∏–π
				timer:start(2000, 0, function()
					count = 0
				end)
				return map  -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–ª–∞–≤–∏—à–∏
			end
		end, { expr = true, silent = true })  -- `expr` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–ª–∞–≤–∏—à–∏ –∫–∞–∫ –∫–æ–º–∞–Ω–¥—ã
	end
end

-- –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é cowboy() –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
M.cowboy()

return M

